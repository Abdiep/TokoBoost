# Firebase App Hosting Configuration
# Reference: https://firebase.google.com/docs/app-hosting/configure

build:
  steps:
    # 1️⃣ Install dependencies
    - name: install
      run: npm ci

    # 2️⃣ Build your Next.js app
    - name: build
      run: npm run build

    # 3️⃣ Start server in production
    - name: start
      run: npm start

runConfig:
  # Jumlah maksimal instance (auto scaling)
  maxInstances: 1

  # Environment variables (diambil dari Firebase Secrets)
  env:
    - key: SERVICE_ACCOUNT_KEY
      secret: SERVICE_ACCOUNT_KEY
    - key: DATABASE_URL
      secret: DATABASE_URL
    - key: GEMINI_API_KEY
      secret: GEMINI_API_KEY
    - key: MIDTRANS_SERVER_KEY
      secret: MIDTRANS_SERVER_KEY
    - key: NEXT_PUBLIC_MIDTRANS_CLIENT_KEY
      secret: NEXT_PUBLIC_MIDTRANS_CLIENT_KEY