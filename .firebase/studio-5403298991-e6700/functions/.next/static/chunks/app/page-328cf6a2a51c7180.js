(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{78:(e,a,s)=>{Promise.resolve().then(s.bind(s,374))},374:(e,a,s)=>{"use strict";s.d(a,{default:()=>P});var l=s(5155),r=s(2115),i=s(5695),t=s(6766),n=s(285),d=s(6695),c=s(5057),o=s(8539),u=s(8272),m=s(7481),h=s(0),x=s(172),p=s(5300),f=s(6923),g=s(9311),j=s(7933),b=s(7832),v=s(4601),N=s(594),k=s(1949),w=s(5599),y=s(8718),A=s(9051),C=s(9434);let S=r.forwardRef((e,a)=>{let{className:s,children:r,...i}=e;return(0,l.jsxs)(A.bL,{ref:a,className:(0,C.cn)("relative overflow-hidden",s),...i,children:[(0,l.jsx)(A.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,l.jsx)(T,{}),(0,l.jsx)(A.OK,{})]})});S.displayName=A.bL.displayName;let T=r.forwardRef((e,a)=>{let{className:s,orientation:r="vertical",...i}=e;return(0,l.jsx)(A.VM,{ref:a,orientation:r,className:(0,C.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...i,children:(0,l.jsx)(A.lr,{className:"relative flex-1 rounded-full bg-border"})})});function P(){let{isLoggedIn:e,credits:a,user:s}=(0,u.U)(),A=(0,i.useRouter)(),{toast:C}=(0,m.dj)(),[T,P]=(0,r.useTransition)(),[R,B]=(0,r.useState)(null),[G,K]=(0,r.useState)(""),[L,E]=(0,r.useState)([]),[$,F]=(0,r.useState)(null),[I,M]=(0,r.useState)("idle"),U=(0,r.useRef)(null),H=(0,r.useRef)(null);(0,r.useEffect)(()=>{e||A.push("/login")},[e,A]);let _=e=>{var a;let s=null==(a=e.target.files)?void 0:a[0];if(s){if(s.size>4194304)return void C({title:"Gambar Terlalu Besar",description:"Ukuran gambar tidak boleh melebihi 4MB.",variant:"destructive"});let e=new FileReader;e.onloadend=()=>{B(e.result)},e.readAsDataURL(s)}},D=async()=>R&&G?a<2?void C({title:"Kredit Tidak Cukup",description:"Anda memerlukan 2 kredit untuk membuat konten. Silakan top up.",variant:"destructive"}):s?void(M("generating"),E([]),F(null),P(async()=>{try{let e=await s.getIdToken(),a=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({productImage:R,productDescription:G})}),l=await a.json();if(!a.ok)throw Error(l.error||"API request failed with status ".concat(a.status));E(l.captions),F(l.flyerImageUri),M("success"),C({title:"Pembuatan Konten Berhasil!",description:"Caption dan flyer baru Anda telah siap. Kredit Anda akan segera diperbarui."})}catch(e){console.error("AI Generation Error:",e),M("error"),C({title:"Terjadi Kesalahan",description:"Gagal membuat konten. Pesan: ".concat(e instanceof Error?e.message:"Unknown error"),variant:"destructive"})}})):void C({title:"Sesi tidak valid, harap login kembali.",variant:"destructive"}):void C({title:"Data Tidak Lengkap",description:"Harap unggah gambar dan isi deskripsi produk.",variant:"destructive"}),O=e=>{let a="".concat(e.caption,"\n\n").concat(e.hashtags);navigator.clipboard.writeText(a),C({title:"Caption & Hashtag Disalin!",description:"Anda dapat menempelkannya di media sosial."})};if(!e)return(0,l.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,l.jsx)(x.A,{className:"h-12 w-12 animate-spin"})});let z="generating"===I;return(0,l.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,l.jsx)(h.A,{}),(0,l.jsx)("main",{className:"flex-grow container mx-auto px-4 md:px-6 py-8",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[(0,l.jsxs)(d.Zp,{className:"h-fit",children:[(0,l.jsxs)(d.aR,{children:[(0,l.jsxs)(d.ZB,{className:"flex items-center gap-2 font-headline text-2xl",children:[(0,l.jsx)(p.A,{}),"1. Masukkan Detail Produk"]}),(0,l.jsx)(d.BT,{children:"Unggah gambar dan tulis deskripsi singkat produk Anda. Proses ini membutuhkan 2 kredit."})]}),(0,l.jsxs)(d.Wu,{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(c.J,{htmlFor:"product-image",children:"Gambar Produk"}),(0,l.jsxs)("div",{className:"relative flex h-64 w-full items-center justify-center rounded-lg border-2 border-dashed border-border bg-muted/50 p-2",children:[(0,l.jsx)("input",{ref:U,id:"file-upload",type:"file",accept:"image/*",className:"hidden",onChange:_}),(0,l.jsx)("input",{ref:H,id:"camera-upload",type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:_}),R?(0,l.jsx)(t.default,{src:R,alt:"Pratinjau Produk",fill:!0,className:"object-contain"}):(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center text-muted-foreground",children:[(0,l.jsx)(f.A,{className:"h-10 w-10"}),(0,l.jsx)("span",{className:"font-semibold",children:"Pilih Sumber Gambar"}),(0,l.jsxs)("div",{className:"flex w-full gap-3",children:[(0,l.jsxs)(n.$,{variant:"outline",className:"w-full",onClick:()=>{var e;return null==(e=U.current)?void 0:e.click()},children:[(0,l.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Galeri"]}),(0,l.jsxs)(n.$,{variant:"outline",className:"w-full",onClick:()=>{var e;return null==(e=H.current)?void 0:e.click()},children:[(0,l.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Kamera"]})]})]})]}),R&&(0,l.jsx)(n.$,{variant:"link",className:"w-full",onClick:()=>B(null),children:"Hapus Gambar"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(c.J,{htmlFor:"product-description",children:"Deskripsi Produk"}),(0,l.jsx)(o.T,{id:"product-description",placeholder:"Contoh: Sepatu lari ringan dengan teknologi bantalan terbaru, cocok untuk pemula maupun profesional.",rows:5,value:G,onChange:e=>K(e.target.value)})]})]}),(0,l.jsx)(d.wL,{children:(0,l.jsxs)(n.$,{onClick:D,disabled:z||!R||!G,className:"w-full",children:[z?(0,l.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,l.jsx)(b.A,{className:"mr-2 h-4 w-4"}),z?"Membuat Konten...":"Buat Konten (2 Kredit)"]})})]}),(0,l.jsxs)(d.Zp,{className:"flex flex-col",children:[(0,l.jsxs)(d.aR,{children:[(0,l.jsxs)(d.ZB,{className:"flex items-center gap-2 font-headline text-2xl",children:[(0,l.jsx)(v.A,{}),"2. Hasil Generasi AI"]}),(0,l.jsx)(d.BT,{children:"Caption dan flyer yang dihasilkan oleh AI akan muncul di sini."})]}),(0,l.jsxs)(d.Wu,{className:"flex-grow flex flex-col",children:["idle"===I&&(0,l.jsxs)("div",{className:"flex h-full min-h-[400px] flex-col items-center justify-center gap-4 rounded-lg bg-muted/50 p-8 text-center text-muted-foreground",children:[(0,l.jsx)(N.A,{className:"h-12 w-12"}),(0,l.jsx)("p",{children:"Hasil akan ditampilkan di sini setelah Anda membuat konten."})]}),"generating"===I&&(0,l.jsxs)("div",{className:"flex h-full min-h-[400px] flex-col items-center justify-center gap-4 rounded-lg bg-muted/50 p-8 text-center text-muted-foreground",children:[(0,l.jsx)(x.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,l.jsx)("p",{className:"font-semibold",children:"AI sedang bekerja..."}),(0,l.jsx)("p",{children:"Proses ini bisa memakan waktu hingga satu menit."})]}),"error"===I&&(0,l.jsxs)("div",{className:"flex h-full min-h-[400px] flex-col items-center justify-center gap-4 rounded-lg border-2 border-dashed border-destructive bg-destructive/10 p-8 text-center text-destructive",children:[(0,l.jsx)(k.A,{className:"h-12 w-12"}),(0,l.jsx)("p",{className:"font-semibold",children:"Gagal Menghasilkan Konten"}),(0,l.jsx)("p",{className:"text-sm",children:"Terjadi kesalahan. Silakan coba lagi."}),(0,l.jsx)(n.$,{variant:"destructive",onClick:D,children:"Coba Lagi"})]}),"success"===I&&(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 h-full",children:[(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("h3",{className:"font-headline text-lg",children:"Flyer Produk"}),(0,l.jsx)("div",{className:"aspect-[9/16] w-full rounded-lg bg-muted/50 relative overflow-hidden",children:$?(0,l.jsx)(t.default,{src:$,alt:"Generated Flyer",fill:!0,className:"object-cover"}):(0,l.jsxs)("div",{className:"flex items-center justify-center h-full text-muted-foreground text-sm",children:[(0,l.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"})," Sedang memuat flyer..."]})})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("h3",{className:"font-headline text-lg",children:"Saran Caption & Hashtag"}),(0,l.jsx)(S,{className:"h-80 -mr-4 pr-4",children:(0,l.jsx)("div",{className:"space-y-4",children:L.length>0?L.map((e,a)=>(0,l.jsxs)("div",{className:"rounded-lg border bg-card p-4 space-y-3 relative pr-12",children:[(0,l.jsx)("p",{className:"text-sm",children:e.caption}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:e.hashtags}),(0,l.jsx)(n.$,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>O(e),children:(0,l.jsx)(w.A,{className:"h-4 w-4"})})]},a)):(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,l.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin inline-block"})," Sedang memuat caption..."]})})})]})]})]}),(0,l.jsxs)(d.wL,{className:"flex justify-end gap-2",children:[(0,l.jsx)(n.$,{variant:"outline",onClick:()=>{B(null),K(""),E([]),F(null),M("idle")},disabled:z||"success"!==I,children:"Buat Lagi"}),(0,l.jsxs)(n.$,{onClick:()=>{if($){let e=document.createElement("a");e.href=$,e.download="flyer-produk.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)}},disabled:z||!$,children:[(0,l.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Unduh Flyer"]})]})]})]})})]})}T.displayName=A.VM.displayName},5057:(e,a,s)=>{"use strict";s.d(a,{J:()=>c});var l=s(5155),r=s(2115),i=s(968),t=s(2085),n=s(9434);let d=(0,t.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,l.jsx)(i.b,{ref:a,className:(0,n.cn)(d(),s),...r})});c.displayName=i.b.displayName},8539:(e,a,s)=>{"use strict";s.d(a,{T:()=>t});var l=s(5155),r=s(2115),i=s(9434);let t=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,l.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...r})});t.displayName="Textarea"}},e=>{var a=a=>e(e.s=a);e.O(0,[507,644,72,567,97,766,959,0,441,684,358],()=>a(78)),_N_E=e.O()}]);